(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{1886:function(e,t,r){Promise.resolve().then(r.bind(r,1914))},1914:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=r(3827),s=r(4090),o=r(7907),n=r(3779),i=r(8714),l=r(7546),d=r(8009);function c(){let{user:e,isLoading:t}=(0,n.a)(),r=(0,o.useRouter)(),c=(0,i.createClientComponentClient)(),[u,h]=(0,s.useState)([]),[g,m]=(0,s.useState)(!0),[x,p]=(0,s.useState)(null),[b,f]=(0,s.useState)("all"),[v,y]=(0,s.useState)(""),[w,j]=(0,s.useState)(null);async function N(e,t){try{j(e);let{error:r}=await c.from("products").update({is_active:t,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;h(u.map(r=>r.id===e?{...r,is_active:t,updated_at:new Date().toISOString()}:r)),d.Am.success("Product ".concat(t?"activated":"deactivated"," successfully"))}catch(e){console.error("Error updating product status:",e),d.Am.error("Failed to update product status: "+e.message)}finally{j(null)}}async function C(e,t){try{j(e);let{error:r}=await c.from("products").update({stock:t,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;h(u.map(r=>r.id===e?{...r,stock:t,updated_at:new Date().toISOString()}:r)),d.Am.success("Stock updated successfully")}catch(e){console.error("Error updating product stock:",e),d.Am.error("Failed to update product stock: "+e.message)}finally{j(null)}}(0,s.useEffect)(()=>{async function t(){try{m(!0),p(null);let e=c.from("products").select("*").order("name");"active"===b?e=e.eq("is_active",!0):"inactive"===b&&(e=e.eq("is_active",!1));let{data:t,error:r}=await e;if(r)throw r;h(t||[])}catch(e){console.error("Error fetching products:",e),p(e.message||"Failed to load products")}finally{m(!1)}}e&&t()},[e,c,b]);let k=(0,s.useMemo)(()=>{if(!v.trim())return u;let e=v.toLowerCase();return u.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))},[u,v]);return t?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin mb-4"}),(0,a.jsx)("p",{className:"text-gray-300 text-lg",children:"Checking authentication..."})]}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Products Management"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>r.push("/dashboard/products/new"),className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Add New Product"}),(0,a.jsx)("button",{onClick:()=>r.push("/dashboard"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Dashboard"})]})]}),x&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:x}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-[1fr_auto] gap-4 bg-gray-800/50 p-4 rounded-lg border border-gray-700/50 shadow-md",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"Search products by name or description...",className:"w-full px-4 py-2 pl-10 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50"}),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,a.jsx)("div",{className:"w-full sm:w-auto",children:(0,a.jsxs)("select",{value:b,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[(0,a.jsx)("option",{value:"all",children:"All Products"}),(0,a.jsx)("option",{value:"active",children:"Active Only"}),(0,a.jsx)("option",{value:"inactive",children:"Inactive Only"})]})})]}),g?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin mb-4"}),(0,a.jsx)("p",{className:"ml-3 text-xl text-gray-300",children:"Loading products..."})]}):0===k.length?(0,a.jsxs)("div",{className:"bg-gray-800/80 p-8 rounded-xl shadow-lg text-center border border-gray-700/50",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-300 mb-2",children:"No products found"}),(0,a.jsx)("p",{className:"text-gray-400",children:v?"Try adjusting your search or filter criteria.":"Add some products to get started."}),v&&(0,a.jsx)("button",{onClick:()=>y(""),className:"mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white text-sm transition-colors",children:"Clear Search"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map(e=>(0,a.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-xl shadow-lg flex flex-col border border-gray-700/50 hover:border-gray-500/50 transition-all duration-300 group",children:[(0,a.jsxs)("div",{className:"relative mb-4 pt-[100%] bg-gray-900/50 rounded overflow-hidden group-hover:shadow-lg transition-all duration-300",children:[e.image?(0,a.jsx)(l.bz,{src:e.image,alt:e.name,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"absolute top-0 left-0 w-full h-full object-contain rounded p-2 transition-transform duration-300 group-hover:scale-105"}):(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-700 flex items-center justify-center rounded",children:(0,a.jsx)("span",{className:"text-gray-400",children:"No image"})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 px-2 py-1 rounded-full text-xs ".concat(e.is_active?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:e.is_active?"Active":"Inactive"})]}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-2 text-gray-100 group-hover:text-white transition-colors duration-200",children:e.name}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mb-3 line-clamp-2 flex-grow",children:e.description}),(0,a.jsxs)("div",{className:"border-t border-gray-700 pt-3 mt-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsxs)("p",{className:"font-bold text-lg bg-clip-text text-transparent bg-gradient-to-r from-amber-500 to-orange-600",children:["â‚¬",Number(e.price).toFixed(2)]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400 mr-2",children:"Stock:"}),(0,a.jsx)("input",{type:"number",min:"0",value:e.stock,onChange:t=>C(e.id,parseInt(t.target.value)),className:"w-16 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-center text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50",disabled:w===e.id})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>r.push("/dashboard/products/".concat(e.id)),className:"flex-1 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white text-sm transition-colors hover:shadow-md",disabled:w===e.id,children:"Edit"}),(0,a.jsx)("button",{onClick:()=>N(e.id,!e.is_active),className:"flex-1 px-3 py-2 rounded text-white text-sm transition-colors hover:shadow-md ".concat(e.is_active?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),disabled:w===e.id,children:w===e.id?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):e.is_active?"Deactivate":"Activate"})]})]})]},e.id))})]}):(r.push("/login"),null)}},3779:function(e,t,r){"use strict";r.d(t,{H:function(){return l},a:function(){return d}});var a=r(3827),s=r(4090),o=r(7907),n=r(8714);let i=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),u=(0,o.useRouter)(),h=(0,n.createClientComponentClient)();(0,s.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await h.auth.getUser();l(e)}catch(e){console.error("Error getting user:",e)}finally{c(!1)}})();let{data:{subscription:e}}=h.auth.onAuthStateChange((e,t)=>{var r;l(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),c(!1)});return()=>{e.unsubscribe()}},[h,u]);let g=async(e,t)=>{try{let{data:r,error:a}=await h.auth.signInWithPassword({email:e,password:t});if(a)throw a;l(r.user);let{data:{session:s}}=await h.auth.getSession();(null==s?void 0:s.user)&&u.push("/dashboard")}catch(e){throw console.error("Sign in error:",e),e}},m=async()=>{await h.auth.signOut(),u.push("/"),u.refresh()};return(0,a.jsx)(i.Provider,{value:{user:r,isLoading:d,signIn:g,signOut:m},children:t})},d=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[676,714,9,546,971,69,744],function(){return e(e.s=1886)}),_N_E=e.O()}]);