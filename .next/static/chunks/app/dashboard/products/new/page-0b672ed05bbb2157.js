(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56],{3206:function(e,r,t){Promise.resolve().then(t.bind(t,1731))},1731:function(e,r,t){"use strict";let s;t.r(r),t.d(r,{default:function(){return p}});var a=t(3827),o=t(4090),n=t(7907),i=t(3779),l=t(8714),c=t(7546),d={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let u=new Uint8Array(16),m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));var g=function(e,r,t){var a,o,n;if(d.randomUUID&&!r&&!e)return d.randomUUID();let i=null!==(n=null!==(o=(e=e||{}).random)&&void 0!==o?o:null===(a=e.rng)||void 0===a?void 0:a.call(e))&&void 0!==n?n:function(){if(!s){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");s=crypto.getRandomValues.bind(crypto)}return s(u)}();if(i.length<16)throw Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,r){if((t=t||0)<0||t+16>r.length)throw RangeError("UUID byte range ".concat(t,":").concat(t+15," is out of buffer bounds"));for(let e=0;e<16;++e)r[t+e]=i[e];return r}return function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(m[e[r+0]]+m[e[r+1]]+m[e[r+2]]+m[e[r+3]]+"-"+m[e[r+4]]+m[e[r+5]]+"-"+m[e[r+6]]+m[e[r+7]]+"-"+m[e[r+8]]+m[e[r+9]]+"-"+m[e[r+10]]+m[e[r+11]]+m[e[r+12]]+m[e[r+13]]+m[e[r+14]]+m[e[r+15]]).toLowerCase()}(i)},h=t(8009);function p(){let{user:e,isLoading:r}=(0,i.a)(),t=(0,n.useRouter)(),s=(0,l.createClientComponentClient)(),[d,u]=(0,o.useState)(null),[m,p]=(0,o.useState)(!1),[b,x]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),[v,j]=(0,o.useState)(""),[w,N]=(0,o.useState)("1"),[k,C]=(0,o.useState)(!0),[S,A]=(0,o.useState)(""),[P,E]=(0,o.useState)([]),I=async e=>{e.preventDefault();try{if(p(!0),u(null),!b.trim())throw Error("Product name is required");if(!f.trim())throw Error("Description is required");if(!v||0>=parseFloat(v))throw Error("Price must be greater than zero");if(!w||0>parseInt(w))throw Error("Stock cannot be negative");if(!S.trim())throw Error("Main image is required");let e={id:g(),name:b,description:f,price:parseFloat(v),stock:parseInt(w),is_active:k,image:S,cloudinary_id:S,images:[S,...P.filter(e=>e)],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:r}=await s.from("products").insert([e]);if(r)throw r;h.Am.success("Product created successfully"),t.push("/dashboard/products")}catch(e){console.error("Error creating product:",e),u(e.message||"Failed to create product"),h.Am.error(e.message||"Failed to create product"),p(!1)}},U=e=>{E(P.filter(r=>r!==e)),h.Am.success("Image removed")},_=(0,o.useCallback)(e=>{A(e.public_id),h.Am.success("Main image uploaded successfully")},[]),D=(0,o.useCallback)(e=>{let r=e.public_id;E(e=>[...e,r]),h.Am.success("Additional image uploaded successfully")},[]),R=e=>{S&&S!==e&&E(r=>[...r.filter(r=>r!==e),S]),A(e),E(r=>r.filter(r=>r!==e)),h.Am.success("Main image updated")};return r?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin mb-4"}),(0,a.jsx)("p",{className:"text-xl text-gray-300",children:"Checking authentication..."})]}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Add New Product"}),(0,a.jsx)("button",{onClick:()=>t.push("/dashboard/products"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Products"})]}),d&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:d}),(0,a.jsx)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-xl shadow-lg border border-gray-700/50",children:(0,a.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Product Name"}),(0,a.jsx)("input",{type:"text",value:b,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"Enter product name",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,a.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50 min-h-[150px]",placeholder:"Describe your product",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Price (â‚¬)"}),(0,a.jsx)("input",{type:"number",min:"0.01",step:"0.01",value:v,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"0.00",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stock"}),(0,a.jsx)("input",{type:"number",min:"0",value:w,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"1",required:!0})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer select-none",children:[(0,a.jsx)("input",{type:"checkbox",checked:k,onChange:e=>C(e.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 text-blue-600 focus:ring-offset-gray-800"}),(0,a.jsx)("span",{children:"Active (visible in shop)"})]})})]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Main Product Image"}),S?(0,a.jsxs)("div",{className:"relative rounded-lg overflow-hidden border-2 border-gray-700 h-64 group bg-gray-900/50",children:[(0,a.jsx)(c.bz,{src:S,alt:"Main product image",fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"object-contain transition-transform duration-300 group-hover:scale-105 p-2"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-2",children:[(0,a.jsx)(c.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&_(e.info)},children:e=>{let{open:r}=e;return(0,a.jsx)("button",{type:"button",onClick:()=>r(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-white text-sm",children:"Replace"})}}),(0,a.jsx)("button",{type:"button",onClick:()=>A(""),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-white text-sm",children:"Remove"})]})})]}):(0,a.jsx)(c.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&_(e.info)},children:e=>{let{open:r}=e;return(0,a.jsxs)("button",{type:"button",onClick:()=>r(),className:"w-full h-64 border-2 border-dashed border-gray-600 rounded-lg flex flex-col items-center justify-center bg-gray-700/30 hover:bg-gray-700/50 transition-colors duration-200",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Upload main product image"}),(0,a.jsx)("p",{className:"text-gray-500 text-xs",children:"Click to browse"})]})}}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"Additional Images"}),(0,a.jsx)(c.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&D(e.info)},children:e=>{let{open:r}=e;return(0,a.jsx)("button",{type:"button",onClick:()=>r(),className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded text-white",children:"Add Image"})}})]}),P.length>0?(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:P.map((e,r)=>(0,a.jsxs)("div",{className:"relative group rounded-lg overflow-hidden border border-gray-700 h-24 bg-gray-900/50",children:[(0,a.jsx)(c.bz,{src:e,alt:"Additional image ".concat(r+1),fill:!0,sizes:"(max-width: 768px) 33vw, 100px",className:"object-contain transition-all duration-200 group-hover:opacity-80 p-1"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>R(e),className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-white text-xs",children:"Set Main"}),(0,a.jsx)("button",{type:"button",onClick:()=>U(e),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-white text-xs",children:"Remove"})]})})]},r))}):(0,a.jsx)("div",{className:"text-center bg-gray-800/50 p-4 rounded-lg border border-gray-700/50",children:(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No additional images"})})]})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-700 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>t.push("/dashboard/products"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white transition-colors shadow-md",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded text-white transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Product..."]}):"Create Product"})]})]})})]}):(t.push("/login"),null)}},3779:function(e,r,t){"use strict";t.d(r,{H:function(){return l},a:function(){return c}});var s=t(3827),a=t(4090),o=t(7907),n=t(8714);let i=(0,a.createContext)(void 0),l=e=>{let{children:r}=e,[t,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),u=(0,o.useRouter)(),m=(0,n.createClientComponentClient)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await m.auth.getUser();l(e)}catch(e){console.error("Error getting user:",e)}finally{d(!1)}})();let{data:{subscription:e}}=m.auth.onAuthStateChange((e,r)=>{var t;l(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),d(!1)});return()=>{e.unsubscribe()}},[m,u]);let g=async(e,r)=>{try{let{data:t,error:s}=await m.auth.signInWithPassword({email:e,password:r});if(s)throw s;l(t.user);let{data:{session:a}}=await m.auth.getSession();(null==a?void 0:a.user)&&u.push("/dashboard")}catch(e){throw console.error("Sign in error:",e),e}},h=async()=>{await m.auth.signOut(),u.push("/"),u.refresh()};return(0,s.jsx)(i.Provider,{value:{user:t,isLoading:c,signIn:g,signOut:h},children:r})},c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[676,714,9,546,971,69,744],function(){return e(e.s=3206)}),_N_E=e.O()}]);