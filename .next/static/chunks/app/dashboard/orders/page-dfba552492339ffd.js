(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[857],{4702:function(e,s,t){Promise.resolve().then(t.bind(t,5829))},5829:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var r=t(3827),a=t(4090),l=t(7907),n=t(3779),o=t(8714),d=t(2007),i=t(8009);function c(){let{user:e,isLoading:s}=(0,n.a)(),t=(0,l.useRouter)(),c=(0,o.createClientComponentClient)(),[x,m]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[p,g]=(0,a.useState)(null),[b,y]=(0,a.useState)("all"),[j,f]=(0,a.useState)("created_at"),[w,v]=(0,a.useState)("desc"),[N,_]=(0,a.useState)(""),[C,k]=(0,a.useState)(null),[S,L]=(0,a.useState)(null),[M,A]=(0,a.useState)(!1);(0,a.useEffect)(()=>{async function s(){try{h(!0),g(null);let e=c.from("orders").select("*");"all"!==b&&(e=e.eq("status",b)),e=e.order(j,{ascending:"asc"===w});let{data:s,error:t}=await e;if(t)throw t;m(s||[])}catch(e){console.error("Error fetching orders:",e),g(e.message||"Failed to load orders"),i.Am.error("Failed to load orders")}finally{h(!1)}}e&&s()},[e,c,b,j,w]);let O=e=>{e===j?v("asc"===w?"desc":"asc"):(f(e),v("desc"))};async function E(e,s){try{k(e);let{error:t}=await c.from("orders").update({status:s,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t;m(x.map(t=>t.id===e?{...t,status:s,updated_at:new Date().toISOString()}:t)),i.Am.success("Order status updated to ".concat(s))}catch(e){console.error("Error updating order status:",e),i.Am.error("Failed to update order status: "+e.message)}finally{k(null)}}let D=e=>{L(e),A(!0)},P=()=>{A(!1),setTimeout(()=>L(null),300)},W=(0,a.useMemo)(()=>{if(!N.trim())return x;let e=N.toLowerCase();return x.filter(s=>s.order_number.toLowerCase().includes(e)||"".concat(s.customer_first_name," ").concat(s.customer_last_name).toLowerCase().includes(e)||s.customer_email.toLowerCase().includes(e))},[x,N]);return s?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-gray-300 text-lg",children:"Checking authentication..."})]}):e?(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Orders Management"}),(0,r.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Dashboard"})]}),p&&(0,r.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:p}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-[1fr_auto] gap-4 bg-gray-800/50 p-4 rounded-lg border border-gray-700/50 shadow-md",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:N,onChange:e=>_(e.target.value),placeholder:"Search by order #, customer name or email...",className:"w-full px-4 py-2 pl-10 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50"}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,r.jsx)("div",{className:"w-full sm:w-auto",children:(0,r.jsxs)("select",{value:b,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",children:[(0,r.jsx)("option",{value:"all",children:"All Statuses"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"paid",children:"Paid"}),(0,r.jsx)("option",{value:"shipped",children:"Shipped"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"})]})})]}),u?(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"ml-3 text-xl text-gray-300",children:"Loading orders..."})]}):0===W.length?(0,r.jsxs)("div",{className:"bg-gray-800/80 p-8 rounded-xl shadow-lg text-center border border-gray-700/50",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,r.jsx)("h3",{className:"text-xl font-medium text-gray-300 mb-2",children:"No orders found"}),(0,r.jsx)("p",{className:"text-gray-400",children:N||"all"!==b?"Try adjusting your search or filter criteria.":"New orders will appear here."}),(N||"all"!==b)&&(0,r.jsx)("button",{onClick:()=>{_(""),y("all")},className:"mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white text-sm transition-colors",children:"Clear Filters"})]}):(0,r.jsxs)("div",{className:"bg-gray-800/80 rounded-xl shadow-lg overflow-hidden border border-gray-700/50",children:[(0,r.jsx)("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:(0,r.jsx)("div",{className:"min-w-[768px] px-4 sm:px-0",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left bg-gray-700/50",children:[(0,r.jsx)("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-700/80 transition-colors text-xs sm:text-sm",onClick:()=>O("order_number"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Order Number","order_number"===j&&(0,r.jsx)("span",{className:"ml-1",children:"asc"===w?"↑":"↓"})]})}),(0,r.jsx)("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-700/80 transition-colors text-xs sm:text-sm",onClick:()=>O("customer_last_name"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Customer","customer_last_name"===j&&(0,r.jsx)("span",{className:"ml-1",children:"asc"===w?"↑":"↓"})]})}),(0,r.jsx)("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-700/80 transition-colors text-xs sm:text-sm",onClick:()=>O("created_at"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Date","created_at"===j&&(0,r.jsx)("span",{className:"ml-1",children:"asc"===w?"↑":"↓"})]})}),(0,r.jsx)("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-700/80 transition-colors text-xs sm:text-sm",onClick:()=>O("total_amount"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Amount","total_amount"===j&&(0,r.jsx)("span",{className:"ml-1",children:"asc"===w?"↑":"↓"})]})}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs sm:text-sm",children:"Status"}),(0,r.jsx)("th",{className:"px-4 py-3 text-xs sm:text-sm",children:"Email"}),(0,r.jsx)("th",{className:"px-4 py-3 text-right text-xs sm:text-sm",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:W.map(e=>(0,r.jsxs)("tr",{className:"border-t border-gray-700/30 hover:bg-gray-700/20 transition-colors",children:[(0,r.jsxs)("td",{className:"px-4 py-3 font-medium text-white text-xs sm:text-sm",children:["#",e.order_number]}),(0,r.jsxs)("td",{className:"px-4 py-3 text-xs sm:text-sm",children:[(0,r.jsxs)("div",{className:"font-medium cursor-pointer hover:text-blue-400 transition-colors flex items-center gap-1",onClick:()=>D(e),children:[e.customer_first_name," ",e.customer_last_name,(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),(0,r.jsx)("div",{className:"text-[10px] sm:text-xs text-gray-400 mt-1 truncate max-w-[150px] sm:max-w-none",children:e.customer_email})]}),(0,r.jsxs)("td",{className:"px-4 py-3 text-gray-300 text-xs sm:text-sm whitespace-nowrap",children:[(0,d.WU)(new Date(e.created_at),"MMM dd, yyyy"),(0,r.jsx)("div",{className:"text-[10px] text-gray-500 sm:hidden",children:(0,d.WU)(new Date(e.created_at),"HH:mm")})]}),(0,r.jsxs)("td",{className:"px-4 py-3 font-medium text-amber-500 text-xs sm:text-sm whitespace-nowrap",children:["€",Number(e.total_amount).toFixed(2)]}),(0,r.jsx)("td",{className:"px-4 py-3 text-xs sm:text-sm",children:(0,r.jsx)("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium ".concat("paid"===e.status?"bg-green-500/20 text-green-400 border border-green-500/30":"shipped"===e.status?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"completed"===e.status?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"cancelled"===e.status?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,r.jsx)("td",{className:"px-4 py-3 text-xs sm:text-sm",children:(0,r.jsx)("span",{className:"px-1.5 py-0.5 sm:px-2 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium ".concat(e.emails_sent?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:e.emails_sent?"Sent":"Not Sent"})}),(0,r.jsx)("td",{className:"px-4 py-3 text-right whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>t.push("/dashboard/orders/".concat(e.id)),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-white text-[10px] sm:text-xs transition-colors shadow-sm hover:shadow-md",children:"View"}),(0,r.jsxs)("select",{value:e.status,onChange:s=>E(e.id,s.target.value),disabled:C===e.id,className:"px-2 py-1 bg-gray-700 border border-gray-600 rounded text-[10px] sm:text-xs focus:outline-none focus:ring-2 focus:ring-blue-500/50 cursor-pointer",children:[(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"paid",children:"Paid"}),(0,r.jsx)("option",{value:"shipped",children:"Shipped"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})})]},e.id))})]})})}),(0,r.jsxs)("div",{className:"mt-3 pb-2 flex justify-center sm:hidden",children:[(0,r.jsx)("div",{className:"w-16 h-1 bg-gray-700 rounded-full relative overflow-hidden",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-blue-500/50 animate-pulse rounded-full"})}),(0,r.jsx)("span",{className:"sr-only",children:"Scroll horizontally to see more"})]})]}),M&&S&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:P,children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl max-w-md w-full shadow-2xl border border-gray-700 transform transition-all duration-300 ".concat(M?"scale-100 opacity-100":"scale-95 opacity-0"),onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-700 p-4",children:[(0,r.jsx)("h3",{className:"text-xl font-medium text-white",children:"Customer Details"}),(0,r.jsx)("button",{onClick:P,className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"p-5 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Name"}),(0,r.jsxs)("p",{className:"font-medium",children:[S.customer_first_name," ",S.customer_last_name]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Email"}),(0,r.jsx)("p",{className:"font-medium break-all",children:S.customer_email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Address"}),(0,r.jsx)("p",{className:"font-medium",children:S.customer_address}),(0,r.jsxs)("p",{children:[S.customer_postal_code,", ",S.customer_city]}),(0,r.jsx)("p",{children:S.customer_country})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Order Number"}),(0,r.jsxs)("p",{className:"font-medium",children:["#",S.order_number]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Order Date"}),(0,r.jsx)("p",{className:"font-medium",children:(0,d.WU)(new Date(S.created_at),"MMMM dd, yyyy HH:mm")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Order Status"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium inline-block ".concat("paid"===S.status?"bg-green-500/20 text-green-400 border border-green-500/30":"shipped"===S.status?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"completed"===S.status?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"cancelled"===S.status?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30"),children:S.status.charAt(0).toUpperCase()+S.status.slice(1)})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-700 p-4 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:P,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white transition-colors",children:"Close"}),(0,r.jsx)("button",{onClick:()=>{P(),t.push("/dashboard/orders/".concat(S.id))},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white transition-colors",children:"View Order"})]})]})})]}):(t.push("/login"),null)}},3779:function(e,s,t){"use strict";t.d(s,{H:function(){return d},a:function(){return i}});var r=t(3827),a=t(4090),l=t(7907),n=t(8714);let o=(0,a.createContext)(void 0),d=e=>{let{children:s}=e,[t,d]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0),x=(0,l.useRouter)(),m=(0,n.createClientComponentClient)();(0,a.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await m.auth.getUser();d(e)}catch(e){console.error("Error getting user:",e)}finally{c(!1)}})();let{data:{subscription:e}}=m.auth.onAuthStateChange((e,s)=>{var t;d(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),c(!1)});return()=>{e.unsubscribe()}},[m,x]);let u=async(e,s)=>{try{let{data:t,error:r}=await m.auth.signInWithPassword({email:e,password:s});if(r)throw r;d(t.user);let{data:{session:a}}=await m.auth.getSession();(null==a?void 0:a.user)&&x.push("/dashboard")}catch(e){throw console.error("Sign in error:",e),e}},h=async()=>{await m.auth.signOut(),x.push("/"),x.refresh()};return(0,r.jsx)(o.Provider,{value:{user:t,isLoading:i,signIn:u,signOut:h},children:s})},i=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[676,714,9,7,971,69,744],function(){return e(e.s=4702)}),_N_E=e.O()}]);