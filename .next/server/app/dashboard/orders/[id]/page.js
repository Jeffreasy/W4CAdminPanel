(()=>{var e={};e.id=190,e.ids=[190],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},6837:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>n});var r=s(482),a=s(9108),d=s(2563),o=s.n(d),l=s(8300),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);s.d(t,i);let n=["",{children:["dashboard",{children:["orders",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8058)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\orders\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3096)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1342)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\orders\\[id]\\page.tsx"],m="/dashboard/orders/[id]/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/orders/[id]/page",pathname:"/dashboard/orders/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},919:(e,t,s)=>{Promise.resolve().then(s.bind(s,7578))},7578:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(5344),a=s(3729),d=s(8428),o=s(5814),l=s(7435),i=s(7509),n=s(5305),c=s(4669);function m({params:e}){let{user:t,isLoading:s}=(0,o.a)(),m=(0,d.useRouter)(),x=(0,l.createClientComponentClient)(),[u,p]=(0,a.useState)(null),[h,g]=(0,a.useState)([]),[b,y]=(0,a.useState)(!0),[f,j]=(0,a.useState)(null),[w,N]=(0,a.useState)(!1),[v,_]=(0,a.useState)(null),[k,P]=(0,a.useState)(null);async function C(t){try{N(!0);let{error:s}=await x.from("orders").update({status:t,updated_at:new Date().toISOString()}).eq("id",e.id);if(s)throw s;u&&p({...u,status:t,updated_at:new Date().toISOString()}),c.Am.success(`Order status updated to ${t}`)}catch(e){console.error("Error updating order status:",e),c.Am.error("Failed to update order status: "+e.message)}finally{N(!1)}}async function q(){try{N(!0);let t=await fetch("/api/orders/send-emails-wfc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e.id,customer:{name:`${u?.customer_first_name} ${u?.customer_last_name}`,email:u?.customer_email,address:u?.customer_address,city:u?.customer_city,postalCode:u?.customer_postal_code,country:u?.customer_country}})});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to send emails")}let{error:s}=await x.from("orders").update({emails_sent:!0}).eq("id",e.id);if(s)throw s;u&&p({...u,emails_sent:!0}),c.Am.success("Confirmation emails sent successfully")}catch(e){console.error("Error sending emails:",e),c.Am.error("Failed to send emails: "+e.message)}finally{N(!1)}}(0,a.useEffect)(()=>{async function s(){try{y(!0),j(null);let{data:t,error:s}=await x.from("orders").select("*").eq("id",e.id).single();if(s)throw s;let{data:r,error:a}=await x.from("order_items").select("*").eq("order_id",e.id);if(a)throw a;let d=await Promise.all(r.map(async e=>{let{data:t,error:s}=await x.from("products").select("name, image").eq("id",e.product_id).single();return s?(console.error("Error fetching product:",s),{...e,product:{name:"Unknown Product",image:""}}):{...e,product:t}})),{data:o,error:l}=await x.from("orders").select("id, order_number").order("created_at",{ascending:!1});if(l)throw l;if(o&&o.length>0){let t=o.findIndex(t=>t.id===e.id);t>0?_(o[t-1].id):_(null),t<o.length-1?P(o[t+1].id):P(null)}p(t),g(d)}catch(e){console.error("Error fetching order details:",e),j(e.message||"Failed to load order details"),c.Am.error("Failed to load order details")}finally{y(!1)}}t&&e.id&&s()},[t,e.id,x]);let S=(0,a.useMemo)(()=>h.length?{totalItems:h.length,totalQuantity:h.reduce((e,t)=>e+t.quantity,0)}:{totalItems:0,totalQuantity:0},[h]);return s||b?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-t-blue-500 border-gray-700 rounded-full animate-spin mb-4"}),r.jsx("p",{className:"text-gray-300 text-lg",children:s?"Checking authentication...":"Loading order details..."})]}):t?u?(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,r.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:["Order #",u.order_number]}),r.jsx("button",{onClick:()=>m.push("/dashboard/orders"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Orders"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("button",{onClick:()=>v&&m.push(`/dashboard/orders/${v}`),disabled:!v,className:`px-3 py-2 rounded text-sm transition-colors ${v?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]})}),r.jsx("span",{className:"text-gray-400 text-xs sm:text-sm",children:!b&&u&&(0,r.jsxs)(r.Fragment,{children:["Order ID: ",r.jsx("span",{className:"text-gray-300 font-mono text-xs",children:e.id})]})}),r.jsx("button",{onClick:()=>k&&m.push(`/dashboard/orders/${k}`),disabled:!k,className:`px-3 py-2 rounded text-sm transition-colors ${k?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:(0,r.jsxs)("span",{className:"flex items-center",children:["Next",r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),f&&r.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:f}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-4 sm:p-6 rounded-xl shadow-lg md:col-span-2 border border-gray-700/50",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Order Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-y-5 gap-x-3 sm:gap-x-4 mb-6 sm:mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Date"}),r.jsx("p",{className:"font-medium text-sm sm:text-base",children:(0,i.WU)(new Date(u.created_at),"MMMM dd, yyyy")}),r.jsx("p",{className:"text-xs text-gray-400",children:(0,i.WU)(new Date(u.created_at),"HH:mm:ss")})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Status"}),r.jsx("div",{className:"flex items-center gap-2 mt-1",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${"paid"===u.status?"bg-green-500/20 text-green-400 border border-green-500/30":"shipped"===u.status?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"completed"===u.status?"bg-purple-500/20 text-purple-400 border border-purple-500/30":"cancelled"===u.status?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30"}`,children:u.status.charAt(0).toUpperCase()+u.status.slice(1)})})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Total Amount"}),(0,r.jsxs)("p",{className:"text-lg sm:text-xl font-bold text-amber-500",children:["€",Number(u.total_amount).toFixed(2)]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Emails"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${u.emails_sent?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:u.emails_sent?"Sent":"Not Sent"}),!u.emails_sent&&r.jsx("button",{onClick:q,disabled:w,className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 rounded text-white text-xs transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Sending...":"Send Now"})]})]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-700 my-4 sm:my-6 pt-4 sm:pt-6",children:[(0,r.jsxs)("h3",{className:"text-base sm:text-lg font-medium mb-3 sm:mb-4",children:["Order Items (",S.totalItems," items, ",S.totalQuantity," total quantities)"]}),0===h.length?r.jsx("div",{className:"bg-gray-800/50 p-4 rounded-lg border border-gray-700/50 text-center",children:r.jsx("p",{className:"text-gray-400",children:"No items found for this order"})}):r.jsx("div",{className:"space-y-3 sm:space-y-4",children:h.map(e=>(0,r.jsxs)("div",{className:"bg-gray-800/50 p-3 sm:p-4 rounded-lg border border-gray-700/50 flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[r.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 relative bg-gray-900/50 rounded-lg overflow-hidden flex-shrink-0",children:e.product?.image?r.jsx(n.bz,{src:e.product.image,alt:e.product?.name||"Product",fill:!0,sizes:"(max-width: 768px) 80px, 100px",className:"object-contain p-2"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 sm:h-10 sm:w-10 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,r.jsxs)("div",{className:"flex-grow text-center sm:text-left",children:[r.jsx("h4",{className:"font-medium text-sm sm:text-base line-clamp-2",children:e.product?.name||"Unknown Product"}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-center sm:justify-start gap-2 sm:gap-4 mt-2",children:[(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-400",children:["Quantity: ",r.jsx("span",{className:"text-white font-medium",children:e.quantity})]}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-400",children:["Price: ",(0,r.jsxs)("span",{className:"text-amber-500 font-medium",children:["€",Number(e.price).toFixed(2)]})]}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-gray-400",children:["Subtotal: ",(0,r.jsxs)("span",{className:"text-amber-500 font-medium",children:["€",(e.quantity*e.price).toFixed(2)]})]})]})]}),e.product_id&&r.jsx("button",{onClick:()=>m.push(`/dashboard/products/${e.product_id}`),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white text-xs transition-colors shadow-sm hover:shadow-md flex-shrink-0",children:"View Product"})]},e.id))})]}),r.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-center sm:justify-end gap-3",children:[r.jsx("div",{className:"w-full sm:w-auto order-2 sm:order-1",children:r.jsx("button",{onClick:()=>m.push("/dashboard/orders"),className:"w-full sm:w-auto px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white transition-colors shadow-md",children:"Back to Orders"})}),r.jsx("div",{className:"w-full sm:w-auto order-1 sm:order-2",children:(0,r.jsxs)("select",{value:u.status,onChange:e=>C(e.target.value),disabled:w,className:"w-full sm:w-auto px-3 py-2 bg-gray-700 border border-gray-600 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"paid",children:"Paid"}),r.jsx("option",{value:"shipped",children:"Shipped"}),r.jsx("option",{value:"completed",children:"Completed"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]})})]}),(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-4 sm:p-6 rounded-xl shadow-lg border border-gray-700/50",children:[r.jsx("h3",{className:"text-base sm:text-lg font-medium mb-3 sm:mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Customer Details"}),(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Name"}),(0,r.jsxs)("p",{className:"font-medium text-sm sm:text-base",children:[u.customer_first_name," ",u.customer_last_name]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Email"}),r.jsx("p",{className:"font-medium text-sm sm:text-base break-all",children:u.customer_email})]}),(0,r.jsxs)("div",{className:"border-t border-gray-700 pt-3 sm:pt-4",children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Shipping Address"}),r.jsx("p",{className:"font-medium text-sm sm:text-base",children:u.customer_address}),(0,r.jsxs)("p",{className:"text-sm",children:[u.customer_postal_code,", ",u.customer_city]}),r.jsx("p",{className:"text-sm",children:u.customer_country})]})]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-4 sm:p-6 rounded-xl shadow-lg border border-gray-700/50",children:[r.jsx("h3",{className:"text-base sm:text-lg font-medium mb-3 sm:mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Payment Information"}),(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Status"}),r.jsx("p",{className:"font-medium",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${"paid"===u.status||"completed"===u.status||"shipped"===u.status?"bg-green-500/20 text-green-400 border border-green-500/30":"cancelled"===u.status?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30"}`,children:"paid"===u.status||"completed"===u.status||"shipped"===u.status?"Payment Completed":"cancelled"===u.status?"Payment Cancelled":"Payment Pending"})})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Total Amount"}),(0,r.jsxs)("p",{className:"text-lg sm:text-xl font-bold text-amber-500",children:["€",Number(u.total_amount).toFixed(2)]})]}),u.payment_reference&&(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mb-1",children:"Payment Reference"}),r.jsx("p",{className:"font-mono text-xs sm:text-sm break-all bg-gray-900/50 p-2 rounded border border-gray-700",children:u.payment_reference})]})]})]})]})]})]}):(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Order Not Found"}),r.jsx("button",{onClick:()=>m.push("/dashboard/orders"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Orders"})]}),r.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:f||"Order not found or you do not have permission to view it."})]}):(m.push("/login"),null)}},8058:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>d,__esModule:()=>a,default:()=>o});let r=(0,s(6843).createProxy)(String.raw`C:\Users\jeffrey\Desktop\MAIN WHISKY\W4CAdminPanel\src\app\dashboard\orders\[id]\page.tsx`),{__esModule:a,$$typeof:d}=r,o=r.default}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[22,964,763,305,509,294],()=>s(6837));module.exports=r})();