(()=>{var e={};e.id=340,e.ids=[340],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},9211:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=t(482),a=t(9108),o=t(2563),i=t.n(o),n=t(8300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let d=["",{children:["dashboard",{children:["products",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6426)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\products\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3096)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1342)),"C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\jeffrey\\Desktop\\MAIN WHISKY\\W4CAdminPanel\\src\\app\\dashboard\\products\\[id]\\page.tsx"],u="/dashboard/products/[id]/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/products/[id]/page",pathname:"/dashboard/products/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8141:(e,r,t)=>{Promise.resolve().then(t.bind(t,1559))},1559:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(5344),a=t(3729),o=t(8428),i=t(5814),n=t(7435),l=t(5305),d=t(4669);function c({params:e}){let{user:r,isLoading:t}=(0,i.a)(),c=(0,o.useRouter)(),u=(0,n.createClientComponentClient)(),[p,x]=(0,a.useState)(null),[m,g]=(0,a.useState)(!0),[h,b]=(0,a.useState)(null),[y,f]=(0,a.useState)(!1),[v,j]=(0,a.useState)(null),[w,N]=(0,a.useState)(""),[k,C]=(0,a.useState)(""),[P,S]=(0,a.useState)(""),[q,A]=(0,a.useState)(""),[_,M]=(0,a.useState)(!0),[I,E]=(0,a.useState)(""),[W,D]=(0,a.useState)([]),[F,L]=(0,a.useState)(null),[z,$]=(0,a.useState)(null);(0,a.useEffect)(()=>{async function t(){try{g(!0),b(null);let{data:r,error:t}=await u.from("products").select("*").eq("id",e.id).single();if(t){if("PGRST116"===t.code)throw Error("Product not found");throw t}x(r),N(r.name||""),C(r.description||""),S(r.price?r.price.toString():""),A(r.stock?r.stock.toString():""),M(!!r.is_active),E(r.image||""),D(Array.isArray(r.images)?r.images.filter(e=>e!==r.image&&e):[]);let{data:s}=await u.from("products").select("id, name").order("name");if(s&&s.length>0){let r=s.findIndex(r=>r.id===e.id);r>0?L(s[r-1].id):L(null),r<s.length-1?$(s[r+1].id):$(null)}}catch(e){console.error("Error fetching product details:",e),b(e.message||"Failed to load product details")}finally{g(!1)}}r&&e.id&&t()},[r,e.id,u]);let B=async r=>{r.preventDefault();try{if(f(!0),b(null),j(null),!w.trim())throw Error("Product name is required");if(!k.trim())throw Error("Description is required");if(!P||0>=parseFloat(P))throw Error("Price must be greater than zero");if(!q||0>parseInt(q))throw Error("Stock cannot be negative");if(!I.trim())throw Error("Main image is required");let r={name:w,description:k,price:parseFloat(P),stock:parseInt(q),is_active:_,image:I,images:[I,...W.filter(e=>e)],updated_at:new Date().toISOString()},{error:t}=await u.from("products").update(r).eq("id",e.id);if(t)throw t;d.Am.success("Product updated successfully"),j("Product updated successfully"),x({...p,...r}),setTimeout(()=>{f(!1)},1e3)}catch(e){console.error("Error updating product:",e),b(e.message||"Failed to update product"),d.Am.error(e.message||"Failed to update product"),f(!1)}},H=e=>{D(W.filter(r=>r!==e)),d.Am.success("Image removed")},R=(0,a.useCallback)(e=>{E(e.public_id),d.Am.success("Main image uploaded successfully")},[]),U=(0,a.useCallback)(e=>{let r=e.public_id;D(e=>[...e,r]),d.Am.success("Additional image uploaded successfully")},[]),G=e=>{I&&I!==e&&D(r=>[...r.filter(r=>r!==e),I]),E(e),D(r=>r.filter(r=>r!==e)),d.Am.success("Main image updated")};return t||m?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:[s.jsx("div",{className:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin mb-4"}),s.jsx("p",{className:"text-xl text-gray-300",children:t?"Checking authentication...":"Loading product details..."})]}):r?p||m?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:["Edit Product: ",w]}),s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:()=>c.push("/dashboard/products"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Products"})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("button",{onClick:()=>F&&c.push(`/dashboard/products/${F}`),disabled:!F,className:`px-3 py-1.5 rounded text-sm transition-colors ${F?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:(0,s.jsxs)("span",{className:"flex items-center",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous Product"]})}),s.jsx("span",{className:"text-gray-400 text-sm",children:!m&&p&&(0,s.jsxs)(s.Fragment,{children:["ID: ",s.jsx("span",{className:"text-gray-300 font-mono",children:e.id})]})}),s.jsx("button",{onClick:()=>z&&c.push(`/dashboard/products/${z}`),disabled:!z,className:`px-3 py-1.5 rounded text-sm transition-colors ${z?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:(0,s.jsxs)("span",{className:"flex items-center",children:["Next Product",s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),h&&s.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:h}),v&&s.jsx("div",{className:"bg-green-500/10 border border-green-500/30 p-4 rounded-lg text-green-400",children:v}),s.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-xl shadow-lg border border-gray-700/50",children:(0,s.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Product Name"}),s.jsx("input",{type:"text",value:w,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"Enter product name",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),s.jsx("textarea",{value:k,onChange:e=>C(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50 min-h-[150px]",placeholder:"Describe your product",required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Price (â‚¬)"}),s.jsx("input",{type:"number",min:"0",step:"0.01",value:P,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"0.00",required:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Stock"}),s.jsx("input",{type:"number",min:"0",value:q,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"0",required:!0})]})]}),s.jsx("div",{children:(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer select-none",children:[s.jsx("input",{type:"checkbox",checked:_,onChange:e=>M(e.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 text-blue-600 focus:ring-offset-gray-800"}),s.jsx("span",{children:"Active (visible in shop)"})]})})]}),s.jsx("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-3",children:"Main Product Image"}),I?(0,s.jsxs)("div",{className:"relative rounded-lg overflow-hidden border-2 border-gray-700 h-64 group bg-gray-900/50",children:[s.jsx(l.bz,{src:I,alt:"Main product image",fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"object-contain transition-transform duration-300 group-hover:scale-105 p-2"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:(0,s.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-2",children:[s.jsx(l.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&R(e.info)},children:({open:e})=>s.jsx("button",{type:"button",onClick:()=>e(),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-white text-sm",children:"Replace"})}),s.jsx("button",{type:"button",onClick:()=>E(""),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-white text-sm",children:"Remove"})]})})]}):s.jsx(l.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&R(e.info)},children:({open:e})=>(0,s.jsxs)("button",{type:"button",onClick:()=>e(),className:"w-full h-64 border-2 border-dashed border-gray-600 rounded-lg flex flex-col items-center justify-center bg-gray-700/30 hover:bg-gray-700/50 transition-colors duration-200",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Upload main product image"}),s.jsx("p",{className:"text-gray-500 text-xs",children:"Click to browse"})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("label",{className:"block text-sm font-medium",children:"Additional Images"}),s.jsx(l.ZF,{uploadPreset:"product_images",onSuccess:e=>{e.info&&U(e.info)},children:({open:e})=>s.jsx("button",{type:"button",onClick:()=>e(),className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded text-white",children:"Add Image"})})]}),W.length>0?s.jsx("div",{className:"grid grid-cols-3 gap-3",children:W.map((e,r)=>(0,s.jsxs)("div",{className:"relative group rounded-lg overflow-hidden border border-gray-700 h-24 bg-gray-900/50",children:[s.jsx(l.bz,{src:e,alt:`Additional image ${r+1}`,fill:!0,sizes:"(max-width: 768px) 33vw, 100px",className:"object-contain transition-all duration-200 group-hover:opacity-80 p-1"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 flex items-center justify-center group-hover:bg-opacity-50 transition-all duration-300",children:(0,s.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex space-x-1",children:[s.jsx("button",{type:"button",onClick:()=>G(e),className:"px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-white text-xs",children:"Set Main"}),s.jsx("button",{type:"button",onClick:()=>H(e),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-white text-xs",children:"Remove"})]})})]},r))}):s.jsx("div",{className:"text-center bg-gray-800/50 p-4 rounded-lg border border-gray-700/50",children:s.jsx("p",{className:"text-gray-500 text-sm",children:"No additional images"})})]})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-700 mt-6",children:[s.jsx("button",{type:"button",onClick:()=>c.push("/dashboard/products"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-white transition-colors shadow-md",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-white transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:y?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving Changes..."]}):"Save Changes"})]})]})})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-300",children:"Product Not Found"}),s.jsx("button",{onClick:()=>c.push("/dashboard/products"),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-md text-white text-sm transition-colors shadow-md hover:shadow-lg hover:-translate-y-0.5 transform duration-200",children:"Back to Products"})]}),s.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-lg text-red-400 animate-pulse",children:h||"Product not found or you do not have permission to view it."})]}):(c.push("/login"),null)}},6426:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>o,__esModule:()=>a,default:()=>i});let s=(0,t(6843).createProxy)(String.raw`C:\Users\jeffrey\Desktop\MAIN WHISKY\W4CAdminPanel\src\app\dashboard\products\[id]\page.tsx`),{__esModule:a,$$typeof:o}=s,i=s.default}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[22,964,763,305,294],()=>t(9211));module.exports=s})();